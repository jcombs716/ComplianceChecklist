<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NYS School Facilities Compliance Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; }
        .table-container { overflow-x: auto; border-radius: 8px; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1); }
        tr:nth-child(even) { background-color: #f1f5f9; }
        .badge { padding: 0.25rem 0.6rem; border-radius: 9999px; font-size: 0.75rem; font-weight: 600; text-transform: uppercase; }
        .badge-annual { background-color: #dcfce7; color: #166534; }
        .badge-periodic { background-color: #fef9c3; color: #854d0e; }
        .badge-event { background-color: #fee2e2; color: #991b1b; }
    </style>
</head>
<body class="p-4 md:p-8">
    <div class="max-w-7xl mx-auto">
        <header class="mb-8">
            <h1 class="text-3xl font-bold text-slate-900">NYS School District Compliance Matrix</h1>
            <p class="text-slate-600 mt-2">Comprehensive tracking for Facilities, Fire Safety, Environmental, and Health & Safety requirements.</p>
        </header>

        <div class="mb-6 grid grid-cols-1 md:grid-cols-3 gap-4">
            <input type="text" id="searchInput" placeholder="Search tasks, agencies, or laws..." 
                   class="p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none">
            
            <select id="categoryFilter" class="p-3 border border-slate-300 rounded-lg outline-none">
                <option value="">All Categories</option>
                <option value="Facilities">Facilities</option>
                <option value="Fire Safety">Fire Safety</option>
                <option value="Environmental">Environmental</option>
                <option value="Health & Safety">Health & Safety</option>
                <option value="Admin/Transportation">Admin/Transportation</option>
            </select>

            <div class="flex items-center justify-end text-sm text-slate-500">
                <span id="rowCount">0</span> items found
            </div>
        </div>

        <div class="table-container bg-white">
            <table class="w-full text-left border-collapse">
                <thead class="bg-slate-800 text-white">
                    <tr>
                        <th class="p-4 font-semibold text-sm">Category / Sub</th>
                        <th class="p-4 font-semibold text-sm">Task</th>
                        <th class="p-4 font-semibold text-sm">Frequency</th>
                        <th class="p-4 font-semibold text-sm">Authority</th>
                        <th class="p-4 font-semibold text-sm">Action Required</th>
                        <th class="p-4 font-semibold text-sm">Citation</th>
                    </tr>
                </thead>
                <tbody id="complianceBody" class="text-slate-700 text-sm">
                    <!-- Data injected via JS -->
                </tbody>
            </table>
        </div>
    </div>

    <script>
        const complianceData = [
            { cat: "Facilities", sub: "Structural", task: "Visual Inspection", freq: "Annually", auth: "NYSED", action: "Inspection", by: "Team (incl. Code Official)", cite: "8 NYCRR § 155.4" },
            { cat: "Facilities", sub: "Structural", task: "Building Condition Survey (BCS)", freq: "Every 5 Years", auth: "NYSED", action: "Survey & Report", by: "Licensed Architect/PE", cite: "8 NYCRR § 155.4" },
            { cat: "Facilities", sub: "Planning", task: "5-Year Capital Facilities Plan", freq: "Annual Update", auth: "NYSED", action: "Review & Update", by: "BOE / Admin", cite: "8 NYCRR § 155.1" },
            { cat: "Facilities", sub: "Mechanical", task: "Boiler Inspection (High Pressure)", freq: "Annual", auth: "NYS DOL", action: "Inspection", by: "Authorized Inspector", cite: "Labor Law § 204" },
            { cat: "Facilities", sub: "Mechanical", task: "Boiler Inspection (Low Pressure)", freq: "Every 2 Years", auth: "NYS DOL", action: "Inspection", by: "Authorized Inspector", cite: "Labor Law § 204" },
            { cat: "Facilities", sub: "Mechanical", task: "Elevator / Chairlift Inspection", freq: "Every 6 Months", auth: "NYS Code Enforcement", action: "Inspection", by: "Licensed Inspector", cite: "PMCNYS § 606.1" },
            { cat: "Facilities", sub: "Water Systems", task: "Backflow Prevention Test", freq: "Annual", auth: "NYS DOH", action: "Testing", by: "Certified Tester", cite: "10 NYCRR § 5-1.31" },
            { cat: "Facilities", sub: "Equipment", task: "Gym Bleacher Inspection", freq: "Annual", auth: "NYS Fire Code", action: "Inspection", by: "Qualified Person", cite: "FCNYS § 1029.1.1" },
            { cat: "Facilities", sub: "Equipment", task: "Stage Rigging Inspection", freq: "Annual", auth: "OSHA", action: "Inspection", by: "Qualified Person", cite: "OSHA General Duty" },
            { cat: "Facilities", sub: "Recreational", task: "Swimming Pool Permit", freq: "Annual", auth: "County DOH", action: "Permit Renewal", by: "County DOH", cite: "10 NYCRR § 6-1.4" },
            { cat: "Fire Safety", sub: "General", task: "Annual Fire Safety Inspection", freq: "Annually", auth: "NYSED / Fire Code", action: "Inspection", by: "Code Official", cite: "Ed. Law § 807-A" },
            { cat: "Fire Safety", sub: "Drills", task: "Fire Evacuation Drills", freq: "12x Year", auth: "NYSED", action: "Drill Execution", by: "Principal", cite: "Ed. Law § 807" },
            { cat: "Fire Safety", sub: "Drills", task: "Lockdown Drills", freq: "4x Year", auth: "NYSED", action: "Drill Execution", by: "Principal", cite: "Ed. Law § 807" },
            { cat: "Fire Safety", sub: "Systems", task: "Fire Alarm System Testing", freq: "Annual", auth: "NYS Fire Code", action: "Testing", by: "Licensed Contractor", cite: "FCNYS § 907.8" },
            { cat: "Fire Safety", sub: "Systems", task: "Sprinkler System Testing", freq: "Annual", auth: "NYS Fire Code", action: "Testing", by: "Licensed Contractor", cite: "FCNYS § 903.5" },
            { cat: "Fire Safety", sub: "Equipment", task: "Fire Extinguishers (Visual)", freq: "Monthly", auth: "NYS Fire Code", action: "Visual Check", by: "In-House", cite: "FCNYS § 906.2" },
            { cat: "Fire Safety", sub: "Equipment", task: "Fire Extinguishers (Service)", freq: "Annual", auth: "NYS Fire Code", action: "Service & Tag", by: "Licensed Contractor", cite: "FCNYS § 906.2" },
            { cat: "Fire Safety", sub: "Kitchen", task: "Range Hood Inspection", freq: "Every 6 Months", auth: "NYS Fire Code", action: "Inspection", by: "Licensed Contractor", cite: "FCNYS § 607.3.3" },
            { cat: "Fire Safety", sub: "Lighting", task: "Emergency Lights (Function)", freq: "Monthly (30s)", auth: "NYS Fire Code", action: "Functional Test", by: "In-House", cite: "FCNYS § 604.5" },
            { cat: "Fire Safety", sub: "Power", task: "Emergency Generator (Run)", freq: "Monthly", auth: "NYS Fire Code", action: "Load Test", by: "In-House", cite: "FCNYS § 604.3" },
            { cat: "Environmental", sub: "Water", task: "Lead in Water Testing", freq: "Every 3 Years", auth: "NYS DOH", action: "Sampling & Lab", by: "In-House/Lab", cite: "10 NYCRR § 67-4" },
            { cat: "Environmental", sub: "Asbestos", task: "Asbestos 6-Month Surveillance", freq: "Every 6 Months", auth: "EPA (AHERA)", action: "Visual Inspection", by: "Designee", cite: "40 CFR § 763.92" },
            { cat: "Environmental", sub: "Asbestos", task: "Asbestos Re-Inspection", freq: "Every 3 Years", auth: "EPA (AHERA)", action: "Full Inspection", by: "Licensed Inspector", cite: "40 CFR § 763.85" },
            { cat: "Environmental", sub: "Pest Mgmt", task: "Pesticide Notification (IPM)", freq: "48hr Prior", auth: "NYSED", action: "Notify Occupants", by: "In-House", cite: "Ed. Law § 409-H" },
            { cat: "Environmental", sub: "Fuel Tanks", task: "Petroleum Tank Registration", freq: "Every 5 Years", auth: "NYS DEC", action: "Submit Renewal", by: "In-House", cite: "6 NYCRR § 613-1" },
            { cat: "Environmental", sub: "Chemical", task: "Chemical Inventory", freq: "Annual", auth: "OSHA", action: "Inventory Audit", by: "CHO", cite: "29 CFR § 1910.1450" },
            { cat: "Health & Safety", sub: "Training", task: "Right-To-Know Training", freq: "Annual", auth: "PESH/OSHA", action: "Staff Training", by: "In-House/Vendor", cite: "29 CFR § 1910.1200" },
            { cat: "Health & Safety", sub: "Training", task: "Bloodborne Pathogen", freq: "Annual", auth: "PESH/OSHA", action: "Staff Training", by: "In-House/Nurse", cite: "29 CFR § 1910.1030" },
            { cat: "Health & Safety", sub: "Medical", task: "Eyewash Station", freq: "Weekly (Flush)", auth: "NYS Plumbing", action: "Activation Test", by: "In-House", cite: "PCNYS § 411" },
            { cat: "Admin/Transportation", sub: "Planning", task: "School Safety Plan (SAVE)", freq: "Annual", auth: "NYSED", action: "Plan Update", by: "Safety Team/BOE", cite: "Ed. Law § 2801-A" },
            { cat: "Admin/Transportation", sub: "Reporting", task: "Bus Accident Reporting", freq: "As Occurs", auth: "NYS DMV", action: "File Report", by: "Transportation", cite: "VTL § 600" },
            { cat: "Admin/Transportation", sub: "Equipment", task: "AED Inspection", freq: "Monthly", auth: "NYSED", action: "Check Readiness", by: "Nurse/Vendor", cite: "Ed. Law § 917" }
        ];

        const tbody = document.getElementById('complianceBody');
        const searchInput = document.getElementById('searchInput');
        const categoryFilter = document.getElementById('categoryFilter');
        const rowCount = document.getElementById('rowCount');

        function getFreqClass(freq) {
            const f = freq.toLowerCase();
            if (f.includes('annual') || f.includes('year')) return 'badge-annual';
            if (f.includes('month') || f.includes('week')) return 'badge-periodic';
            return 'badge-event';
        }

        function renderTable() {
            const searchTerm = searchInput.value.toLowerCase();
            const categoryTerm = categoryFilter.value;
            
            let filtered = complianceData.filter(item => {
                const matchesSearch = Object.values(item).some(val => val.toLowerCase().includes(searchTerm));
                const matchesCategory = categoryTerm === "" || item.cat === categoryTerm;
                return matchesSearch && matchesCategory;
            });

            tbody.innerHTML = filtered.map(item => `
                <tr class="hover:bg-blue-50 transition-colors">
                    <td class="p-4 border-b border-slate-200">
                        <span class="block font-semibold text-blue-800">${item.cat}</span>
                        <span class="text-xs text-slate-500">${item.sub}</span>
                    </td>
                    <td class="p-4 border-b border-slate-200 font-medium">${item.task}</td>
                    <td class="p-4 border-b border-slate-200">
                        <span class="badge ${getFreqClass(item.freq)}">${item.freq}</span>
                    </td>
                    <td class="p-4 border-b border-slate-200 text-xs font-bold uppercase">${item.auth}</td>
                    <td class="p-4 border-b border-slate-200">
                        <span class="block text-slate-700">${item.action}</span>
                        <span class="text-[10px] text-slate-400">By: ${item.by}</span>
                    </td>
                    <td class="p-4 border-b border-slate-200 text-xs font-mono text-blue-600">${item.cite}</td>
                </tr>
            `).join('');

            rowCount.textContent = filtered.length;
        }

        searchInput.addEventListener('input', renderTable);
        categoryFilter.addEventListener('change', renderTable);

        // Initial render
        renderTable();
    </script>
</body>
</html>
